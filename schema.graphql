enum TransferType {
  TRANSFER
  MINT
  BURN
}

type Transfer @index(fields: ["token", ["blockTimestamp", "DESC"]]) {
  id: ID!                    # ${chainId}_${token}_${blockNumber}_${logIndex}
  chainId: Int!
  token: String! @index
  blockNumber: Int!
  blockTimestamp: Int!
  logIndex: Int!
  txHash: String! @index
  from: String! @index
  to: String! @index
  value: BigInt!
  transferType: TransferType!
}

type Account @index(fields: ["token", ["balance", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${address}
  chainId: Int! @index
  token: String! @index
  address: String! @index
  balance: BigInt!
  transfersIn: Int!
  transfersOut: Int!
  firstSeenBlock: Int!
  firstSeenTimestamp: Int!
  lastActiveBlock: Int!
  lastActiveTimestamp: Int!
  approvalsGiven: [Approval!]! @derivedFrom(field: "owner")
  approvalsReceived: [Approval!]! @derivedFrom(field: "spender")
}

type Approval @index(fields: ["token", "chainId"]) {
  id: ID!                    # ${chainId}-${token}-${owner}-${spender}
  chainId: Int! @index
  token: String! @index
  amount: BigInt!
  owner: Account!
  spender: Account!
  lastUpdatedBlock: Int!
  lastUpdatedTimestamp: Int!
}

type TokenSupply @index(fields: ["chainId", "token"]) {
  id: ID!                    # ${chainId}-${token}-supply
  chainId: Int!
  token: String! @index
  totalSupply: BigInt!
  totalMinted: BigInt!
  totalBurned: BigInt!
  mintCount: Int!
  burnCount: Int!
  transferCount: Int!
  lastUpdatedBlock: Int!
  lastUpdatedTimestamp: Int!
}

type HourlySnapshot @index(fields: ["token", ["hourId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${hourId}
  chainId: Int! @index
  token: String! @index
  hourId: Int! @index
  hourStartTimestamp: Int!
  volume: BigInt!
  transferCount: Int!
  mintVolume: BigInt!
  burnVolume: BigInt!
  mintCount: Int!
  burnCount: Int!
  endOfHourSupply: BigInt!
  firstBlockOfHour: Int!
  lastBlockOfHour: Int!
}

type DailySnapshot @index(fields: ["token", ["dayId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${dayId}
  chainId: Int! @index
  token: String! @index
  dayId: Int! @index
  dayStartTimestamp: Int!
  dailyVolume: BigInt!
  dailyTransferCount: Int!
  dailyMintVolume: BigInt!
  dailyBurnVolume: BigInt!
  dailyMintCount: Int!
  dailyBurnCount: Int!
  endOfDaySupply: BigInt!
  firstBlockOfDay: Int!
  lastBlockOfDay: Int!
}

type WeeklySnapshot @index(fields: ["token", ["weekId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${weekId}
  chainId: Int! @index
  token: String! @index
  weekId: Int! @index
  weekStartTimestamp: Int!
  weeklyVolume: BigInt!
  weeklyTransferCount: Int!
  weeklyMintVolume: BigInt!
  weeklyBurnVolume: BigInt!
  weeklyMintCount: Int!
  weeklyBurnCount: Int!
  endOfWeekSupply: BigInt!
  firstBlockOfWeek: Int!
  lastBlockOfWeek: Int!
}

type AccountDailyActivity @index(fields: ["account", "token", ["dayId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${address}-${dayId}
  chainId: Int! @index
  token: String! @index
  account: String! @index
  dayId: Int! @index
  transferCount: Int!
  volumeIn: BigInt!
  volumeOut: BigInt!
}
