# --- COMMENTED OUT: Transfer entity (largest table, ~25-35% of DB)
# --- Raw transfer logs available from block explorers/RPC. Frontend uses AccountBalanceSnapshot instead.
# enum TransferType {
#   TRANSFER
#   MINT
#   BURN
# }
#
# type Transfer @index(fields: ["token", ["blockTimestamp", "DESC"]]) {
#   id: ID!                    # ${chainId}_${token}_${blockNumber}_${logIndex}
#   chainId: Int!
#   token: String!
#   blockNumber: Int!
#   blockTimestamp: Int!
#   logIndex: Int!
#   txHash: String! @index
#   from: String!
#   to: String!
#   value: BigInt!
#   transferType: TransferType!
# }

type Account @index(fields: ["token", ["balance", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${address}
  chainId: Int!
  token: String!
  address: String! @index
  balance: BigInt!
  totalVolumeIn: BigInt!
  totalVolumeOut: BigInt!
  transfersIn: Int!
  transfersOut: Int!
  # firstSeenBlock: Int!     # COMMENTED OUT: frontend only uses timestamp
  firstSeenTimestamp: Int!
  # lastActiveBlock: Int!    # COMMENTED OUT: frontend only uses timestamp
  lastActiveTimestamp: Int!
}

type TokenSupply @index(fields: ["chainId", "token"]) {
  id: ID!                    # ${chainId}-${token}-supply
  chainId: Int!
  token: String!
  totalSupply: BigInt!
  totalMinted: BigInt!
  totalBurned: BigInt!
  allTimeVolume: BigInt!
  holderCount: Int!
  mintCount: Int!
  burnCount: Int!
  transferCount: Int!
  lastUpdatedBlock: Int!
  lastUpdatedTimestamp: Int!
}

# --- COMMENTED OUT: HourlySnapshot (not used by frontend, saves 1 read + 1 write/event)
# type HourlySnapshot @index(fields: ["token", ["hourId", "DESC"]]) {
#   id: ID!                    # ${chainId}-${token}-${hourId}
#   chainId: Int!
#   token: String!
#   hourId: Int!
#   hourStartTimestamp: Int!
#   volume: BigInt!
#   transferCount: Int!
#   mintVolume: BigInt!
#   burnVolume: BigInt!
#   netMintBurnFlow: BigInt!
#   mintCount: Int!
#   burnCount: Int!
#   endOfHourSupply: BigInt!
#   firstBlockOfHour: Int!
#   lastBlockOfHour: Int!
# }

type DailySnapshot @index(fields: ["token", ["dayId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${dayId}
  chainId: Int!
  token: String!
  dayId: Int!
  dayStartTimestamp: Int!
  dailyVolume: BigInt!
  dailyTransferCount: Int!
  # dailyMintVolume: BigInt!   # COMMENTED OUT: not queried by frontend
  # dailyBurnVolume: BigInt!   # COMMENTED OUT: not queried by frontend
  # netMintBurnFlow: BigInt!   # COMMENTED OUT: not queried by frontend
  # dailyMintCount: Int!       # COMMENTED OUT: not queried by frontend
  # dailyBurnCount: Int!       # COMMENTED OUT: not queried by frontend
  uniqueActiveAddresses: Int!
  # newAddressCount: Int!      # COMMENTED OUT: not queried by frontend
  endOfDaySupply: BigInt!
  velocity: BigDecimal! @config(precision: 30, scale: 15)
  # firstBlockOfDay: Int!      # COMMENTED OUT: not queried by frontend
  # lastBlockOfDay: Int!       # COMMENTED OUT: not queried by frontend
}

# --- COMMENTED OUT: WeeklySnapshot (not used by frontend, saves 1 read + 1 write + 1 BigDecimal/event)
# type WeeklySnapshot @index(fields: ["token", ["weekId", "DESC"]]) {
#   id: ID!                    # ${chainId}-${token}-${weekId}
#   chainId: Int!
#   token: String!
#   weekId: Int!
#   weekStartTimestamp: Int!
#   weeklyVolume: BigInt!
#   weeklyTransferCount: Int!
#   weeklyMintVolume: BigInt!
#   weeklyBurnVolume: BigInt!
#   netMintBurnFlow: BigInt!
#   weeklyMintCount: Int!
#   weeklyBurnCount: Int!
#   uniqueActiveAddresses: Int!
#   endOfWeekSupply: BigInt!
#   velocity: BigDecimal! @config(precision: 30, scale: 15)
#   firstBlockOfWeek: Int!
#   lastBlockOfWeek: Int!
# }

# --- COMMENTED OUT: CrossTokenDailySnapshot (not used by frontend, computable from DailySnapshot)
# type CrossTokenDailySnapshot @index(fields: ["chainId", ["dayId", "DESC"]]) {
#   id: ID!                    # ${chainId}-${dayId}
#   chainId: Int!
#   dayId: Int!
#   dayStartTimestamp: Int!
#   totalVolume: BigInt!
#   totalTransferCount: Int!
#   totalMintVolume: BigInt!
#   totalBurnVolume: BigInt!
#   netMintBurnFlow: BigInt!
# }

type AccountBalanceSnapshot @index(fields: ["account", "token", ["blockTimestamp", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${address}-${blockNumber}-${logIndex}
  chainId: Int!
  token: String!
  account: String!
  blockNumber: Int!
  blockTimestamp: Int!
  balance: BigInt!
  balanceChange: BigInt!
  txHash: String!
}

type AccountDailyActivity @index(fields: ["account", "token", ["dayId", "DESC"]]) {
  id: ID!                    # ${chainId}-${token}-${address}-${dayId}
  chainId: Int!
  token: String!
  account: String!
  dayId: Int!
  transferCount: Int!
  volumeIn: BigInt!
  volumeOut: BigInt!
}

# Marker entity for unique address deduplication per day
type DailyActiveAddress {
  id: ID!                    # ${chainId}-${token}-${dayId}-${address}
}

# --- COMMENTED OUT: WeeklyActiveAddress (only needed by WeeklySnapshot which is removed)
# type WeeklyActiveAddress {
#   id: ID!                    # ${chainId}-${token}-${weekId}-${address}
# }
